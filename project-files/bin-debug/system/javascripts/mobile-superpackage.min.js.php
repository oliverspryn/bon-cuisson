<?php
//Include the system core
	require_once("../server/root.php");
	
//Output this file as JavaScript
	header("Content-type: text/javascript");
?>
(function(a){a(document).bind("mobileinit",function(){a.mobile.defaultPageTransition="slide";a.mobile.selectmenu.prototype.options.nativeMenu=false});a(document).bind("pageload",function(d,f){var b=f.xhr.responseText;var e=a(b).filter('section[data-role="page"], section[data-role="dialog"]');for(var c=1;c<=e.length-1;c++){var g=e.eq(c);if(g.attr("id")&&!document.getElementById(g.attr("id"))){g.appendTo("body")}}});a(document).bind("pageinit",function(){a("button.submit").click(function(){var m=a("section.form input#reviewer").val();var d=parseInt(a("section.form select#rating option:selected").attr("value"));var n=a("section.form textarea#review").val();if(m==""||n==""){alert("We will need both a name and a quick review!");return false}if(a("section.empty").length){var g=a("section.empty");g.after('<ul class="reviews"></ul>');g.remove()}var e='<span class="reviewer">'+m+"</span>\n";if(d!=0){e+='<ul class="rating">';for(var f=1;f<=5;f++){if(f<=d){e+='<li class="selected"></li>'}else{e+="<li></li>"}}e+="</ul>"}e+='<span class="review">'+n+"</span>";e+='<span class="date">-- on ';var c=new Date();var h=c.getMonth();var l=c.getDate();var j=c.getFullYear();var b=new Array("January","February","March","April","May","June","July","August","September","October","November","December");e+='<time datetime="'+j+"-"+h+"-"+l+'">'+b[h]+" "+l+", "+j+"</time>";e+="</span>";a("ul.reviews").append("<li>"+e+"</li>");var k=a("ul.reviews li:last").offset().top;a("html, body").animate({scrollTop:k-20});a("section.form input#reviewer").val("");a("section.form select#rating option:selected").prop("selected",false);a("section.form select#rating option:first").attr("selected","selected");a("section.form select#rating").selectmenu("refresh",true);a("section.form textarea#review").val("");a.ajax({url:"<?php echo ROOT; ?>system/server/processors/reviews.php",type:"POST",data:{reviewer:m,rating:d,review:n}})})})})(jQuery);